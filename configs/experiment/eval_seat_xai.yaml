# @package _global_

defaults:
  - override /data: classification_dir
  - override /model: cnn_effnet_v2_s_full
  - override /trainer: gpu
  - override /logger: wandb

tags: ["eval", "xai_segmentation"]

model:
  net:
    multi_head: true
  ckpt_path: ${paths.trained_models}/cnn_misty-wildflower-144.ckpt

data:
  data_dir: ${oc.env:lear_wrinkles_data_path}
  preprocessing_pipeline:
    _target_: src.data.components.preprocessing.preproc_pipeline_manager.PreprocessingPipeline
    steps:
      - _target_: src.data.components.preprocessing.preproc_strategy_split.SplitStep
        split_ratio: [0.7, 0.2, 0.1]
        seed: 42
        merge_classes: false
      - _target_: src.data.components.preprocessing.preproc_strategy_tile.TilingStep
        tile_size: [224, 224]
        min_defective_area_th: 0.02
        discard_background_th: 0.9
        overlap: 10
        contour_iter_step_size: 5
        iterate_over_defective_areas: true
  overwrite_data: false
  batch_size: 64
  num_workers: 3
  pin_memory: false

  val_test_transforms:
    _target_: torchvision.transforms.Compose
    transforms:
      - _target_: torchvision.transforms.ToTensor

  save_predict_images: true
  num_classes: 2

logger:
  wandb:
    project: "inobranda"
    log_model: False # upload lightning ckpts
    entity: "easyodm" # set to name of your wandb team
    group: "wrinkle_calssification_lear"

predict: True